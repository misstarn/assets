<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="theme-color" content="#f44336" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的文件</title>
    <script src="https://misstarn.github.io/assets/public/browser@4.js"></script>
    <link rel="stylesheet" href="https://misstarn.github.io/assets/public/fancybox.css" />
    <style type="text/tailwindcss">
        @theme {
        --color-clifford: #da373d;
      }
        body{
        background: #000;
        }
    </style>
    
</head>

<body>
    <div class="container mx-auto py-10">
        <h1 class="text-center mb-10 font-bold text-3xl">我的文件</h1>
        <div class="grid grid-cols-8 gap-4" id="gallery">
            <!-- 图片列表 -->
        </div>
    </div>

    <script src="https://misstarn.github.io/assets/public/fancybox.umd.js"></script>
    <script>
        Fancybox.bind("[data-fancybox]", {
        // Your custom options
        });

    const user = "misstarn";
    const repo = "assets";
    const folder = "public";
    const apiUrl = `https://api.github.com/repos/${user}/${repo}/contents/${folder}`;

    fetch(apiUrl)
      .then(res => res.json())
      .then(files => {
        const gallery = document.getElementById("gallery");
        files.forEach(file => {
          if (file.download_url) {
            const url = 'https://misstarn.github.io/assets/' + file.path

            const imgFancybox = document.createElement("a");
            imgFancybox.classList.add("w-full", "overflow-hidden", "rounded-md", "shadow-sm", "aspect-square");
            imgFancybox.href = url;
          
            imgFancybox.setAttribute("data-fancybox", "gallery");
            const imgfix = ['jpg', 'jpeg', 'png', 'gif', 'svg', 'webp']
            imgFancybox.innerHTML = `
                <img src="${url}" class="hover:scale-105 duration-500 size-full object-contain ${imgfix.includes(url.split('.').pop()) ? '' : 'hidden'}" alt="${imgfix.includes(url.split('.').pop()) ? url : url.split('.').pop() + '文件'}">
            `

            const copy = document.createElement("div");

            copy.classList.add("mt-2", "cursor-pointer", "underline", "flex", "items-center", "gap-2", "text-sm", "text-gray-500");

            copy.innerHTML = `
                复制链接<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15 1.25h-4.056c-1.838 0-3.294 0-4.433.153c-1.172.158-2.121.49-2.87 1.238c-.748.749-1.08 1.698-1.238 2.87c-.153 1.14-.153 2.595-.153 4.433V16a3.75 3.75 0 0 0 3.166 3.705c.137.764.402 1.416.932 1.947c.602.602 1.36.86 2.26.982c.867.116 1.97.116 3.337.116h3.11c1.367 0 2.47 0 3.337-.116c.9-.122 1.658-.38 2.26-.982s.86-1.36.982-2.26c.116-.867.116-1.97.116-3.337v-5.11c0-1.367 0-2.47-.116-3.337c-.122-.9-.38-1.658-.982-2.26c-.531-.53-1.183-.795-1.947-.932A3.75 3.75 0 0 0 15 1.25m2.13 3.021A2.25 2.25 0 0 0 15 2.75h-4c-1.907 0-3.261.002-4.29.14c-1.005.135-1.585.389-2.008.812S4.025 4.705 3.89 5.71c-.138 1.029-.14 2.383-.14 4.29v6a2.25 2.25 0 0 0 1.521 2.13c-.021-.61-.021-1.3-.021-2.075v-5.11c0-1.367 0-2.47.117-3.337c.12-.9.38-1.658.981-2.26c.602-.602 1.36-.86 2.26-.981c.867-.117 1.97-.117 3.337-.117h3.11c.775 0 1.464 0 2.074.021M7.408 6.41c.277-.277.665-.457 1.4-.556c.754-.101 1.756-.103 3.191-.103h3c1.435 0 2.436.002 3.192.103c.734.099 1.122.28 1.399.556c.277.277.457.665.556 1.4c.101.754.103 1.756.103 3.191v5c0 1.435-.002 2.436-.103 3.192c-.099.734-.28 1.122-.556 1.399c-.277.277-.665.457-1.4.556c-.755.101-1.756.103-3.191.103h-3c-1.435 0-2.437-.002-3.192-.103c-.734-.099-1.122-.28-1.399-.556c-.277-.277-.457-.665-.556-1.4c-.101-.755-.103-1.756-.103-3.191v-5c0-1.435.002-2.437.103-3.192c.099-.734.28-1.122.556-1.399" clip-rule="evenodd"/></svg>
            `

            copy.addEventListener("click", () => {
                navigator.clipboard.writeText(url);
                alert("链接已复制到剪切板");
            });

            const box = document.createElement("div");
            box.classList.add("flex", "flex-col", "items-center");
            box.appendChild(imgFancybox);
            box.appendChild(copy);
           
            gallery.appendChild(box);

            const title = document.createElement("div");
            title.classList = `text-center text-sm overflow-hidden border border-purple-200 px-3 py-1 rounded-md mt-3 line-clamp-1`;
            title.textContent = file?.name;
            title.setAttribute("title", file?.name);

            // 插入到imgFancybox后面
            imgFancybox.insertAdjacentElement("afterend", title);
          }
        });
      });

    </script>
</body>

</html>


